"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.main = void 0;
const replace_in_file_1 = require("replace-in-file");
const execa = require("execa");
const download = require('download');
function replaceVersion(version, scriptFile) {
    const options = {
        files: scriptFile,
        from: /##+/,
        to: `export KEPTN_VERSION=${version}`,
    };
    (0, replace_in_file_1.sync)(options);
}
function installKeptn(scriptFilse) {
    try {
        execa.sync('bash', [scriptFilse]);
    }
    catch (error) {
        console.log(error);
    }
}
async function main(keptnUrl, version) {
    const scriptFile = 'script.sh';
    await download(keptnUrl, scriptFile);
    if (version !== 'latest' && version !== '') {
        replaceVersion(version, scriptFile);
    }
    await installKeptn(scriptFile);
}
exports.main = main;
